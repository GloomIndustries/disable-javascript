'use strict';var browser=browser,promises=!0;void 0===browser&&(browser=chrome,promises=!1);function domContentLoaded(){var e=[{label:'Default state',name:'default_state',type:'radio',options:[{label:'JS on',value:'on'},{label:'JS off',value:'off'}]},{label:'Disable behavior',name:'disable_behavior',type:'radio',options:[{label:'By domain',value:'domain'},{label:'By tab',value:'tab'}]}],t='setting-';function a(e){var a=document.getElementById('domain-list--tbody'),o='',r=!1,l=[],n=document.getElementById('search');for(var s in e)s.startsWith(t)||(l.push(s),r=!0);for(var i=l.length-1;i>=0;i--){s=l[i];var d=new Date(e[s]);o+='<tr>',o+='<td>'+s+'</td>',o+='<td>'+d.toLocaleDateString()+' '+d.toLocaleTimeString()+'</td>',o+='</tr>'}0===o.length?(o+='<tr>',o+='<td class="empty" colspan="2">You have not added any domains to your white-/blacklist yet.</td>',o+='</tr>',n.disabled=!0):n.disabled=!1,a.innerHTML=o;var c=a.querySelectorAll('tr');for(i=0;i<c.length;i++)c[i].addEventListener('click',function(){if(this.classList.contains('active'))this.classList.remove('active');else{for(var e=a.querySelectorAll('tr.active'),t=0;t<e.length;t++)e[t].classList.remove('active');this.classList.add('active'),document.getElementById('remove').disabled=!1}});r&&(document.getElementById('remove-all').disabled=!1)}function o(e){'domain'===e[t+'disable_behavior']?(document.body.classList.remove('disable-behavior--tab'),promises?browser.storage.local.get().then(a):browser.storage.local.get(a)):document.body.classList.add('disable-behavior--tab')}function r(){document.getElementById('remove').disabled=!0,document.getElementById('remove-all').disabled=!0,promises?browser.storage.local.get(t+'disable_behavior').then(o):browser.storage.local.get(t+'disable_behavior',o)}function l(){var e={};e[t+this.name]=this.value,browser.storage.local.set(e),'default_state'===this.name?browser.runtime.sendMessage({type:'default_state',value:this.value}):'disable_behavior'===this.name&&(browser.runtime.sendMessage({type:'disable_behavior',value:this.value}),r())}function n(a){for(var o='',r=0;r<e.length;r++){var n=e[r];o+='<tr>',o+='<td><label>'+n.label+'</label></td>',o+='<td>';for(var s=0;s<e[r].options.length;s++){var i=n.options[s],d=n.name+'-'+i.value,c='';a[t+n.name]===i.value&&(c=' checked="checked"'),o+='<input type="'+n.type+'" name="'+n.name+'" id="'+d+'" value="'+i.value+'"'+c+' />',o+='<label for="'+d+'">'+i.label+'</label>'}o+='</td>',o+='</tr>'}document.getElementById('settings').innerHTML=o;var m=document.querySelectorAll('input[type=radio]');for(r=0;r<m.length;r++)m[r].addEventListener('click',l)}for(var s=document.querySelectorAll('input[type=button]'),i=0;i<s.length;i++)s[i].disabled=!0;!function(){for(var a=[],o=0;o<e.length;o++)a.push(t+e[o].name);promises?browser.storage.local.get(a).then(n):browser.storage.local.get(a,n)}(),r(),document.getElementById('remove').addEventListener('click',function(){for(var e=document.querySelectorAll('#domain-list--tbody tr.active'),t=0;t<e.length;t++){var a=e[t].childNodes[0].innerHTML;promises?browser.storage.local.remove(a).then(r):browser.storage.local.remove(a,r)}}),document.getElementById('remove-all').addEventListener('click',function(){if(confirm('Are you sure to clear your domain list?')){for(var a={},o=0;o<e.length;o++){var l=e[o].name,n=document.querySelector('input[name="'+l+'"]:checked').value;a[t+l]=n}promises?browser.storage.local.clear().then(function(){browser.storage.local.set(a).then(function(){r()})}):browser.storage.local.clear(function(){browser.storage.local.set(a,function(){r()})})}}),document.getElementById('search').value='',document.getElementById('search').addEventListener('keyup',function(){for(var e=document.getElementById('domain-list--tbody').getElementsByTagName('tr'),t=0;t<e.length;t++){var a=e[t].getElementsByTagName('td')[0];a&&(a.innerHTML.toUpperCase().indexOf(this.value.toUpperCase())>-1?e[t].style.display='':e[t].style.display='none')}})}document.addEventListener('DOMContentLoaded',domContentLoaded);