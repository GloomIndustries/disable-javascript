'use strict';var browser=browser,promises=!0;void 0===browser&&(browser=chrome,promises=!1);function domContentLoaded(){var e=[{label:'Default state',name:'default_state',type:'radio',options:[{label:'JS on',value:'on'},{label:'JS off',value:'off'}]},{label:'Disable behavior',name:'disable_behavior',type:'radio',options:[{label:'By domain',value:'domain'},{label:'By tab',value:'tab'}]},{label:'Enable shortcuts',name:'shortcuts',type:'radio',options:[{label:'Yes',value:'true'},{label:'No',value:'false'}]},{label:'Enable context menu item',name:'context_menu',type:'radio',options:[{label:'Yes',value:'true'},{label:'No',value:'false'}]}],t='setting-',a=document.getElementById('add-domain-form-modal'),o=document.getElementById('add-domain-form');function l(e){var a=document.getElementById('domain-list--tbody'),o='',l=!1,n=[],r=document.getElementById('search');for(var s in e)s.startsWith(t)||(n.push(s),l=!0);for(var d=n.length-1;d>=0;d--){s=n[d];var i=new Date(e[s]);o+='<tr>',o+='<td>'+s+'</td>',o+='<td>'+i.toLocaleDateString()+' '+i.toLocaleTimeString()+'</td>',o+='</tr>'}0===o.length?(o+='<tr>',o+='<td class="empty" colspan="2">You have not added any domains to your white-/blacklist yet.</td>',o+='</tr>',r.disabled=!0):r.disabled=!1,a.innerHTML=o;var c=a.querySelectorAll('tr');for(d=0;d<c.length;d++)c[d].addEventListener('click',function(){if(this.classList.contains('active'))this.classList.remove('active');else{for(var e=a.querySelectorAll('tr.active'),t=0;t<e.length;t++)e[t].classList.remove('active');this.classList.add('active'),document.getElementById('remove').disabled=!1}});l&&(document.getElementById('remove-all').disabled=!1)}function n(e){'domain'===e[t+'disable_behavior']?(document.body.classList.remove('disable-behavior--tab'),promises?browser.storage.local.get().then(l):browser.storage.local.get(l)):document.body.classList.add('disable-behavior--tab')}function r(){document.getElementById('remove').disabled=!0,document.getElementById('remove-all').disabled=!0,promises?browser.storage.local.get(t+'disable_behavior').then(n):browser.storage.local.get(t+'disable_behavior',n)}function s(){var e={},a=this.value;switch(this.value){case'true':a=!0;break;case'false':a=!1}e[t+this.name]=a,browser.storage.local.set(e),browser.runtime.sendMessage({type:this.name,value:a}),r()}function d(a){for(var o='',l=0;l<e.length;l++){var n=e[l];o+='<tr>',o+='<td><label>'+n.label+'</label></td>',o+='<td>';for(var r=0;r<e[l].options.length;r++){var d=n.options[r],i=n.name+'-'+d.value,c='';a[t+n.name]===d.value?c=' checked="checked"':!0===a[t+n.name]&&'true'===d.value?c=' checked="checked"':!1===a[t+n.name]&&'false'===d.value&&(c=' checked="checked"'),o+='<input type="'+n.type+'" name="'+n.name+'" id="'+i+'" value="'+d.value+'"'+c+' />',o+='<label for="'+i+'">'+d.label+'</label>'}o+='</td>',o+='</tr>'}document.getElementById('settings').innerHTML=o;var m=document.querySelectorAll('input[type=radio]');for(l=0;l<m.length;l++)m[l].addEventListener('click',s)}for(var i=document.querySelectorAll('input[type=button]'),c=0;c<i.length;c++)switch(i[c].id){case'remove':case'remove-all':i[c].disabled=!0}!function(){for(var a=[],o=0;o<e.length;o++)a.push(t+e[o].name);promises?browser.storage.local.get(a).then(d):browser.storage.local.get(a,d)}(),r(),document.getElementById('remove').addEventListener('click',function(){for(var e=document.querySelectorAll('#domain-list--tbody tr.active'),t=0;t<e.length;t++){var a=e[t].childNodes[0].innerHTML;promises?browser.storage.local.remove(a).then(r):browser.storage.local.remove(a,r)}}),document.getElementById('remove-all').addEventListener('click',function(){if(confirm('Are you sure to clear your domain list?')){for(var a={},o=0;o<e.length;o++){var l=e[o].name,n=document.querySelector('input[name="'+l+'"]:checked').value;a[t+l]=n}promises?browser.storage.local.clear().then(function(){browser.storage.local.set(a).then(function(){r()})}):browser.storage.local.clear(function(){browser.storage.local.set(a,function(){r()})})}}),document.getElementById('add-domain').addEventListener('click',function(){o.reset(),a.style.display='block'}),document.getElementById('add-domain__submit').addEventListener('click',function(){return!1}),document.getElementById('search').value='',document.getElementById('search').addEventListener('keyup',function(){for(var e=document.getElementById('domain-list--tbody').getElementsByTagName('tr'),t=0;t<e.length;t++){var a=e[t].getElementsByTagName('td')[0];a&&(a.innerHTML.toUpperCase().indexOf(this.value.toUpperCase())>-1?e[t].style.display='':e[t].style.display='none')}}),window.addEventListener('click',function(e){e.target===a&&(a.style.display='none')})}document.addEventListener('DOMContentLoaded',domContentLoaded);