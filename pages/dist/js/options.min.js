'use strict';var browser=browser,promises=!0;void 0===browser&&(browser=chrome,promises=!1);function domContentLoaded(){var e=[{label:'Default state',name:'default_state',type:'radio',options:[{label:'JS on',value:'on'},{label:'JS off',value:'off'}]},{label:'Disable behavior',name:'disable_behavior',type:'radio',options:[{label:'By domain',value:'domain'},{label:'By tab',value:'tab'}]},{label:'Enable shortcuts',name:'shortcuts',type:'radio',options:[{label:'Yes',value:'true'},{label:'No',value:'false'}]},{label:'Enable context menu item',name:'context_menu',type:'radio',options:[{label:'Yes',value:'true'},{label:'No',value:'false'}]}],t='setting-';function a(e){var a=document.getElementById('domain-list--tbody'),o='',l=!1,r=[],n=document.getElementById('search');for(var s in e)s.startsWith(t)||(r.push(s),l=!0);for(var i=r.length-1;i>=0;i--){s=r[i];var d=new Date(e[s]);o+='<tr>',o+='<td>'+s+'</td>',o+='<td>'+d.toLocaleDateString()+' '+d.toLocaleTimeString()+'</td>',o+='</tr>'}0===o.length?(o+='<tr>',o+='<td class="empty" colspan="2">You have not added any domains to your white-/blacklist yet.</td>',o+='</tr>',n.disabled=!0):n.disabled=!1,a.innerHTML=o;var c=a.querySelectorAll('tr');for(i=0;i<c.length;i++)c[i].addEventListener('click',function(){if(this.classList.contains('active'))this.classList.remove('active');else{for(var e=a.querySelectorAll('tr.active'),t=0;t<e.length;t++)e[t].classList.remove('active');this.classList.add('active'),document.getElementById('remove').disabled=!1}});l&&(document.getElementById('remove-all').disabled=!1)}function o(e){'domain'===e[t+'disable_behavior']?(document.body.classList.remove('disable-behavior--tab'),promises?browser.storage.local.get().then(a):browser.storage.local.get(a)):document.body.classList.add('disable-behavior--tab')}function l(){document.getElementById('remove').disabled=!0,document.getElementById('remove-all').disabled=!0,promises?browser.storage.local.get(t+'disable_behavior').then(o):browser.storage.local.get(t+'disable_behavior',o)}function r(){var e={},a=this.value;switch(this.value){case'true':a=!0;break;case'false':a=!1}e[t+this.name]=a,browser.storage.local.set(e),browser.runtime.sendMessage({type:this.name,value:a}),l()}function n(a){for(var o='',l=0;l<e.length;l++){var n=e[l];o+='<tr>',o+='<td><label>'+n.label+'</label></td>',o+='<td>';for(var s=0;s<e[l].options.length;s++){var i=n.options[s],d=n.name+'-'+i.value,c='';a[t+n.name]===i.value?c=' checked="checked"':!0===a[t+n.name]&&'true'===i.value?c=' checked="checked"':!1===a[t+n.name]&&'false'===i.value&&(c=' checked="checked"'),o+='<input type="'+n.type+'" name="'+n.name+'" id="'+d+'" value="'+i.value+'"'+c+' />',o+='<label for="'+d+'">'+i.label+'</label>'}o+='</td>',o+='</tr>'}document.getElementById('settings').innerHTML=o;var m=document.querySelectorAll('input[type=radio]');for(l=0;l<m.length;l++)m[l].addEventListener('click',r)}for(var s=document.querySelectorAll('input[type=button]'),i=0;i<s.length;i++)s[i].disabled=!0;!function(){for(var a=[],o=0;o<e.length;o++)a.push(t+e[o].name);promises?browser.storage.local.get(a).then(n):browser.storage.local.get(a,n)}(),l(),document.getElementById('remove').addEventListener('click',function(){for(var e=document.querySelectorAll('#domain-list--tbody tr.active'),t=0;t<e.length;t++){var a=e[t].childNodes[0].innerHTML;promises?browser.storage.local.remove(a).then(l):browser.storage.local.remove(a,l)}}),document.getElementById('remove-all').addEventListener('click',function(){if(confirm('Are you sure to clear your domain list?')){for(var a={},o=0;o<e.length;o++){var r=e[o].name,n=document.querySelector('input[name="'+r+'"]:checked').value;a[t+r]=n}promises?browser.storage.local.clear().then(function(){browser.storage.local.set(a).then(function(){l()})}):browser.storage.local.clear(function(){browser.storage.local.set(a,function(){l()})})}}),document.getElementById('search').value='',document.getElementById('search').addEventListener('keyup',function(){for(var e=document.getElementById('domain-list--tbody').getElementsByTagName('tr'),t=0;t<e.length;t++){var a=e[t].getElementsByTagName('td')[0];a&&(a.innerHTML.toUpperCase().indexOf(this.value.toUpperCase())>-1?e[t].style.display='':e[t].style.display='none')}})}document.addEventListener('DOMContentLoaded',domContentLoaded);